\documentclass[a4paper,12pt,titlepage]{report}


% Fonts and typography
\usepackage[utf8]{inputenc}
\usepackage[french,english]{babel}
\usepackage{longtable}
\usepackage{booktabs}
\usepackage{amsmath}
\usepackage{tikz}
\usepackage{standalone}
\usepackage{placeins}
\usepackage{textcomp}
\usepackage[backend=biber,language=french,backref=true]{biblatex}
\usepackage{shorttoc}
\usepackage{tocbibind}
% \usepackage{flafter}

\def\inputGnumericTable{}
%\usepackage[latin1]{inputenc}
\usepackage{color}
\usepackage{array}
\usepackage{calc}
\usepackage{multirow}
\usepackage{hhline}
\usepackage{ifthen}
\usepackage{lscape}
\usepackage{eso-pic}


%% Typography
\usepackage[no-math]{fontspec}
\defaultfontfeatures{Mapping = tex-text, Scale = MatchLowercase}

%% Fonts
\setmainfont{Verdana}
\setsansfont{Verdana}
\setmonofont[Mapping=tex-ansi, Path=./fonts/]{MesloLGS-Regular}

%% Set Sans font in headings
\usepackage{sectsty}
\allsectionsfont{\sffamily}

%% Set polyglossia language
% \usepackage{polyglossia}
% \setdefaultlanguage{french}


% Page

%% Use full page in book style
\usepackage{fullpage}

%% Set line spacing
\usepackage{setspace}
% \setstretch{1.3}
\onehalfspacing

%% Disable paragraph indentation
\usepackage{parskip}

\usepackage{titlesec}
%\newcommand{\sectionbreak}{\clearpage}

%Nice chapters rendering
\usepackage[Bjornstrup]{fncychap}

\usepackage{etoolbox}
\makeatletter
\patchcmd{\@makechapterhead}{50\p@}{-50\p@}{}{}
\patchcmd{\@makeschapterhead}{50\p@}{-50\p@}{}{}
\patchcmd{\DOTI}{\vskip 80\p@}{\vskip 40\p@}{}{}
\patchcmd{\DOTIS}{\vskip 40\p@}{\vskip 0\p@}{}{}
\makeatother

%% Start sections from new page
%\let\stdsection\section
%\renewcommand\section{\newpage\stdsection}
%
%\let\oldparagraph\paragraph
%\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
%\let\oldsubparagraph\subparagraph
%\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\newenvironment*{remerciements}{%
\renewcommand*{\abstractname}{Remerciements}
\begin{abstract}
}{\end{abstract}}


% Colors

\usepackage{xcolor}

%% Tango color scheme
\definecolor{SkyBlue}{HTML}{3465A4}
\definecolor{DarkSkyBlue}{HTML}{204A87}

\definecolor{Plum}{HTML}{75507B}

\definecolor{ScarletRed}{HTML}{CC0000}

\definecolor{Aluminium1}{HTML}{EEEEEC}
\definecolor{Aluminium6}{HTML}{2e3436}

\definecolor{Black}{HTML}{000000}


% Listings

\usepackage{listings}

\lstdefinelanguage{JavaScript}{
  keywords = {typeof, new, true, false, catch, function, return, null, catch, switch, var, if, in, while, do, else, case, break},
  keywordstyle = \color{SkyBlue}\bfseries,
  ndkeywords = {class, export, boolean, throw, implements, import, this},
  ndkeywordstyle = \color{Aluminium6}\bfseries,
  identifierstyle = \color{Black},
  sensitive = false,
  comment = [l]{//},
  morecomment = [s]{/*}{*/},
  commentstyle = \color{Plum}\ttfamily,
  stringstyle = \color{ScarletRed}\ttfamily,
  morestring = [b]',
  morestring = [b]"
}
\lstset{
    language=bash,
    keywordstyle=\color{blue},
    basicstyle=\ttfamily,
    morekeywords={peter@kbpet},
    alsoletter={:~$},
    morekeywords=[2]{peter@kbpet:},
    keywordstyle=[2]{\color{red}},
    literate={\$}{{\textcolor{red}{\$}}}1 
             {:}{{\textcolor{red}{:}}}1
             {~}{{\textcolor{red}{\textasciitilde}}}1,
 }

\lstset{
  language = JavaScript,
  backgroundcolor = \color{Aluminium1},
  extendedchars = true,
  basicstyle = \normalsize\ttfamily,
  showstringspaces = false,
  showspaces = false,
  tabsize = 1,
  breaklines = true,
  showtabs = false
}


% Links

%% Hyperref
\input{versions/\jobname}
\usepackage[toc,hyperfirst,footnote,acronym,shortcuts,translate=babel]{glossaries}

%% Donâ€™t use Mono font for URLs
\urlstyle{same}


% Images

\usepackage{graphicx}


% Pandoc hacks

%% Normal enumerates processing
\usepackage{enumerate}

% First letter capitalized in glossary
\usepackage{mfirstuc}
\renewcommand{\glsnamefont}[1]{\makefirstuc{#1}}

%% Disable section numbers
\setcounter{secnumdepth}{4}
\setcounter{tocdepth}{4}

\addbibresource{biblio.bib}
\makeglossaries

\input{glossaire}


%Commandes pour page de garde
\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}
 
\newcommand{\blap}[1]{\vbox to 0pt{#1\vss}}
\newcommand\AtUpperLeftCorner[3]{%
  \put(\LenToUnit{#1},\LenToUnit{\dimexpr\paperheight-#2}){\blap{#3}}%
}
\newcommand\AtUpperRightCorner[3]{%
  \put(\LenToUnit{\dimexpr\paperwidth-#1},\LenToUnit{\dimexpr\paperheight-#2}){\blap{\llap{#3}}}%
}

\makeatletter\@addtoreset{section}{part}\makeatother
\renewcommand   \thechapter         {\Roman{chapter}}
\renewcommand   \thesection         {\arabic{section}.}
\renewcommand   \thesubsection      {\Alph{subsection}.}
\renewcommand   \thesubsubsection       {\arabic{subsubsection}.}
\renewcommand   \theparagraph       {\alph{paragraph}.}

\usepackage[titles]{tocloft}

\cftsetindents{chapter}{0em}{3em}
\renewcommand{\cftchappresnum}{Chapitre }

\AtBeginDocument{\addtolength\cftchapnumwidth{\widthof{\bfseries Chapitre }}}
%\cftsetindents{subsection}{3em}{4em}

\makeatletter
\renewcommand*\l@figure{\@dottedtocline{1}{1.5em}{3em}}% 3em instead of 2.3em
\let\l@table\l@figure
\makeatother

\begin{document}
    \pagestyle{empty}
    \selectlanguage{french}
    \pagenumbering{gobble}

    \begin{titlepage}
        \input{title}
    \end{titlepage}
    \ClearShipoutPicture

    \begin{remerciements}
        \input{remerciements}
    \end{remerciements}
    \newpage

    {
        \renewcommand\cftchapafterpnum{\vskip -1em}
        \renewcommand\cftsecafterpnum{\vskip -1em}
        \setlength{\cftbeforesecskip}{0em}
        \setlength{\cftbeforechapskip}{0.7em}
        \shorttableofcontents{Sommaire}{1} % Only sections and chapters
    }

    \selectlanguage{french}
    \begin{abstract}
        \input{resume-fr}
    \end{abstract}
    \selectlanguage{english}
    \begin{abstract}
        \input{resume-en}
    \end{abstract}

    \pagenumbering{arabic}
    \setcounter{page}{1}
    % Book contents
    \selectlanguage{french}
    \pagestyle{plain}

    \input{contenu}
    \newpage
    \printglossary[type=\acronymtype]
    %%% \newpage just to demonstrate that links are correct
    \newpage
    \glossarystyle{altlist}
    \printglossary[type=main]
    \newpage
    \listoffigures
    \newpage
    \tableofcontents
    \printbibliography
\end{document}
